<div class="container module-container">

  <div ng-show="displayError" class="alert alert-danger alert-dismissible fade in" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span>
    </button>
    <ul>
      <li ng-repeat="error in form.$error.required">
        <strong>{{ error.$name }}</strong> is required
      </li>
      <li ng-repeat="error in form.$error.pattern">
        <strong>{{ error.$name }}</strong> is invalid
      </li>
      <li ng-show="formErrors" ng-repeat="error in formErrors">
        <strong>{{error.field}}</strong>
        <span> {{ error.value }}</span>
        <span> {{ error.code }}</span>
      </li>
    </ul>
  </div>

  <!-- Add cash bag modal-->
  <div class="modal fade" id="addCashBagModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Search Store Instance</h4>
        </div>
        <div class="modal-body">
          <div ng-show="displayModalError" class="alert alert-danger alert-dismissible fade in" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span>
            </button>
            <h4>{{ createCashBagError }}</h4>
          </div>
          <form name="createCashBagForm">
            <div class="row">

              <div class="col-xs-4">
                <date-picker
                  id="createCashBagDatePicker"
                  element-class="col-xs-12"
                  disable-date-range="false"
                  start-date-model="scheduleDate"
                  is-search-field="true"
                  label-from="Store Instance Date"
                  min-date="scheduleMinDate"
                  max-date="scheduleMaxDate"
                  required="true">
                </date-picker>
              </div>

              <div class="col-xs-4">
                <div class="form-group">
                  <label for="create-schedule">Schedule Number</label>
                  <select
                    ng-model="selectedSchedule"
                    class="form-control col-md-12"
                    id="create-schedule"
                    ng-options="schedule.scheduleNumber as schedule.scheduleNumber for schedule in filteredSchedulesList">
                    <option disabled value>Select Schedule Number</option>
                  </select>
                </div>
              </div>

              <div class="col-xs-4">
                <div class="form-group">
                  <label for="create-storeNumber">Store Number</label>
                  <select
                    ng-model="selectedStoreNumber"
                    class="form-control col-md-12"
                    id="create-storeNumber"
                    ng-options="store.id as store.storeNumber for store in storeList">
                    <option disabled value>Select Store Number</option>
                  </select>
                </div>
              </div>

            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" ng-click="submitCreate()">Submit</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <div class="list-controls">
    <div class="row item-list-row">
      <div class="col-xs-6">
        <h2 class="view-name">{{viewName}}</h2>
      </div>

      <div class="col-xs-6 text-right">

        <button class="btn btn-default" data-toggle="collapse" data-target="#search-collapse" aria-expanded="false"
                aria-controls="search-collapse">
          <span class="fa fa-filter" aria-hidden="true"></span>
          <span class="hidden-sm hidden-xs">Filter</span>
        </button>

        <button ng-click="showCreatePopup()" class="btn btn-primary">
          <i class="fa fa-plus" aria-hidden="true"></i>
          <span class="hidden-xs">Add Cash Bag</span>
        </button>

      </div>
    </div>
  </div>

  <div class="panel panel-default collapse no-transition" id="search-collapse">
    <form name="cashBagSearchForm" ng-submit="searchCashBag()">
      <div class="panel-body">
        <div class="row">

          <div class="col-md-3 col-sm-6">
            <div class="form-group">
              <label for="cashBag-number">Cash Bag</label>
              <input ng-model="search.cashBagNumber" type="text" class="form-control" id="cashBag-number">
            </div>
          </div>

          <div class="col-xs-12 col-sm-6 col-md-3">
            <div class="form-group">
              <label for="cashBag-bankRef">Bank Ref #</label>
              <select class="form-control" ng-model="search.bankReferenceNumber" id="cashBag-bankRef">
                <option value=""></option>
                <option value="{{ bankRef }}" ng-repeat="bankRef in bankRefList | orderBy:bankRef">{{ bankRef }}</option>
              </select>
            </div>
          </div>

          <div class="col-md-3 col-sm-6">
            <div class="form-group">
              <label for="cashBag-schedule">Schedule Number</label>
              <input ng-model="search.scheduleNumber" type="text" class="form-control" id="cashBag-schedule">
            </div>
          </div>

          <div class="col-md-3 col-sm-6">
            <date-picker
              element-class="col-xs-12"
              disable-date-range="true"
              start-date-model="search.startDate"
              is-search-field="true"
              label-from="Schedule Date">
            </date-picker>
          </div>
        </div>

        <div class="row">

          <div class="col-md-3 col-sm-6">
            <div class="form-group">
              <label for="cashBag-storeNumber">Store Number</label>
              <input ng-model="search.storeNumber" type="text" class="form-control" id="cashBag-storeNumber">
            </div>
          </div>

          <div class="col-md-3 col-sm-6">
            <div class="form-group">
              <label for="cashBag-storeInstanceId">Store Instance</label>
              <input ng-model="search.storeInstanceId" type="text" class="form-control" id="cashBag-storeInstanceId">
            </div>
          </div>

          <div class="col-md-3 col-sm-6">
            <div class="form-group">
              <label for="cashBag-origin">Origin</label>
              <select ng-model="search.arrivalStationCode" class="stations-multi-select" multiple="multiple" id="cashBag-origin">
                <option ng-repeat="station in stationList" value="{{ station.stationCode }}">{{ station.stationCode }} ({{
                  station.stationName}})
                </option>
              </select>
            </div>
          </div>

          <div class="col-md-3 col-sm-6">
            <div class="form-group">
              <label for="cashBag-destination">Destination</label>
              <select ng-model="search.departureStationCode" class="stations-multi-select" multiple="multiple" id="cashBag-destination">
                <option ng-repeat="station in stationList" value="{{ station.stationCode }}">{{ station.stationCode }}
                  ({{ station.stationName}})
                </option>
              </select>
            </div>
          </div>

        </div>
      </div>

      <div class="panel-footer text-right">
        <button type="button" class="btn btn-default" ng-click="clearForm()">Clear</button>
        <button type="submit" class="btn btn-primary">Search</button>
      </div>
    </form>
  </div>

  <table class="table table-bordered table-hover">
    <thead>
    <tr>
      <th>Cash Bag</th>
      <th>Bank Ref #</th>
      <th>Schedule #</th>
      <th>Date</th>
      <th>Store #</th>
      <th>Store Instance</th>
      <th>Origin</th>
      <th>Destination</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr
      ng-repeat="cashBag in cashBagList" ng-class="{'new':isNew(cashBag.id)}">
      <td>{{ cashBag.cashBagNumber }}</td>
      <td>{{ cashBag.bankReferenceNumber }}</td>
      <td>{{ cashBag.scheduleNumber }}</td>
      <td>{{ cashBag.scheduleDate }}</td>
      <td>{{ cashBag.storeNumber }}</td>
      <td>{{ cashBag.storeInstanceId }}</td>
      <td>{{ cashBag.departureStationCode }}</td>
      <td>{{ cashBag.arrivalStationCode }}</td>
      <td>
        <button class="btn btn-info btn-xs" ng-click="viewCashBag(cashBag)">
          <i class="fa fa-file"></i>
        </button>
        <button class="btn btn-primary btn-xs" ng-click="editCashBag(cashBag)" ng-show="isCashBagEditable(cashBag)">
          <i class="fa fa-pencil"></i>
        </button>
      </td>
    </tr>
    </tbody>
  </table>
</div>
<dynamic-left-nav></dynamic-left-nav>
