<div class="modal fade delete-warning-modal">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <h4 class="modal-title">Are you sure?</h4>
      </div>

      <div class="modal-body">
        <p>You are about to permanently delete <strong>{{itemToDelete.itemQty}} {{ itemToDelete.itemName }}</strong></p>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-danger" ng-click="deleteItemFromMenu()">Continue</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
      </div>

    </div>
  </div>
</div>


<div id="overwrite-modal" class="modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Overwrite Menu?</h3>
      </div>
      <div class="modal-body">
        A menu already exists with Menu Code: <b>{{ menu.menuCode }}</b> and Menu Name: <b>{{ menu.menuName }}</b>.
        If you continue, your changes will overwrite the existing menu. Would you still like to continue and save this menu?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="overwriteMenu()">Continue</button>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <form name="menuEditForm" class="form edit-form">
    <div ng-show="displayError" class="alert alert-danger alert-dismissible fade in" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">Ã—</span>
      </button>
      <h4>
        We weren't able to edit your menu!
      </h4>

      <ul>
        <li ng-repeat="error in form.$error.required">
          <strong>{{ error.$name }}</strong> is required
        </li>
        <li ng-repeat="error in form.$error.pattern">
          <strong>{{ error.$name }}</strong> is invalid
        </li>
        <li ng-show="formErrors" ng-repeat="error in formErrors">
          <strong>{{error.field}}</strong>
          <span> {{ error.value }}</span>
          <span> {{ error.code }}</span>
        </li>
      </ul>
    </div>

    <div class="edit-controls">
      <div class="row">
        <div class="col-xs-6">
          <h2 class="view-name">{{viewName}}</h2>
        </div>

        <div class="col-xs-6 text-right">
          <a class="btn btn-default" ng-href="#/menu-list" class="btn">Back</a>
          <button ng-show="menuEditForm.$dirty" class="btn btn-success" ng-click="submitForm()">
            <span class="glyphicon glyphicon-check" aria-hidden="true"></span>
            <span class="hidden-xs">Save</span>
          </button>
        </div>
      </div>
      <p>All required fields are marked with a *</p>
    </div>

    <h3>Menu Information</h3>

    <div class="form-group col-sm-3">
      <label for="menuCode">Menu Code *</label>
      <input custom-validity
             custom-pattern="word"
             required
             type="text"
             maxlength="20"
             class="form-control"
             id="menuCode"
             ng-model="menu.menuCode"
             placeholder="ITM001"
             ng-readonly="isMenuReadOnly()"/>
    </div>

    <div class="form-group col-sm-3">
      <label for="menuName">Menu Name *</label>
      <input custom-validity
             custom-pattern="word"
             required
             type="text"
             maxlength="25"
             class="form-control"
             id="menuName"
             ng-model="menu.menuName"
             placeholder="iPad Mini Retina"
             ng-readonly="isMenuReadOnly()"/>
    </div>

    <date-picker
      class="form-group col-sm-6 col-xs-12"
      element-class="col-xs-6 col-sm-6"
      start-date-model="menu.startDate"
      end-date-model="menu.endDate"
      disable-past="true"
      label-from="Effective From"
      label-to="Effective To"
      disable-start-date="isMenuReadOnly()"
      disable-end-date="isViewOnly()"
      required="true">
    </date-picker>

    <div class="form-group col-sm-12">
      <label for="menuDescription">Description</label>
      <input custom-validity
             custom-pattern="word"
             type="text"
             maxlength="50"
             class="form-control"
             id="menuDescription"
             ng-model="menu.description"
             placeholder="ITM001"
             ng-readonly="isMenuReadOnly()"/>
    </div>

    <h3>Menu Items
      <button class="btn btn-primary btn-xs pull-right" ng-click="addItem()" ng-show="isMenuEditable()">
        <i class="fa fa-plus"></i> Add Item
      </button>
    </h3>

    <table class="table table-responsive table-bordered table-hover">
      <thead>
      <tr>
        <th class="col-xs-4">Product Category</th>
        <th class="col-xs-6">Item Name</th>
        <th class="col-xs-1">Quantity</th>
        <th ng-hide="isMenuReadOnly()" class="col-xs-1">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr ng-repeat="blankItem in newItemList track by $index">
        <td>
          <ui-select
            required="true"
            ng-model="selectedCategories[$index]"
            on-select="filterItems($index)"
            theme="bootstrap"
            placeholder="Select a category to filter the items list...">
            <ui-select-match
              placeholder="Select a category to filter the items list...">{{ $select.selected.name}}
            </ui-select-match>
            <ui-select-choices repeat="category in categories | filter: $select.search | orderBy:'name'">
              <div ng-bind-html="category.name | highlight: $select.search"></div>
            </ui-select-choices>
          </ui-select>
        </td>
        <td>
          <ui-select
            required="true"
            ng-model="newItemList[$index].masterItem"
            theme="bootstrap"
            placeholder="Select or search an item from the list...">
            <ui-select-match
              placeholder="Select or search an item from the list...">{{ $select.selected.itemName}}
            </ui-select-match>
            <ui-select-choices repeat="menuItem in filteredItemsCollection[$index] | filter: $select.search | orderBy:'itemName'">
              <div ng-bind-html="menuItem.itemName | highlight: $select.search"></div>
            </ui-select-choices>
          </ui-select>
        </td>
        <td>
          <input custom-validity
                 custom-pattern="number"
                 type="text"
                 required
                 maxlength="5"
                 class="form-control"
                 ng-model="newItemList[$index].itemQty"
                 placeholder="{{$index}}"/>
        </td>
        <td>
          <button class="btn btn-danger btn-xs" ng-click="deleteNewItem($index)">
            <i class="fa fa-trash"></i>
          </button>
        </td>
      </tr>

      <tr ng-repeat="menuItem in menu.menuItems">
        <td></td>
        <td>{{menuItem.itemName}}</td>
        <td>{{menuItem.itemQty}}</td>
        <td ng-hide="isMenuReadOnly()">
          <button
            ng-show="canDeleteItems()"
            class="btn btn-danger btn-xs"
            ng-click="showDeleteConfirmation(menuItem)">
            <i class="fa fa-trash"></i>
          </button>
        </td>
      </tr>

      </tbody>
    </table>

  </form>
</div>
