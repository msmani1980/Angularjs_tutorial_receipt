<div class="module-container">

  <div class="edit-controls">
    <div class="row">

      <div class="col-xs-6">
        <h2 class="view-name"> {{ viewName }} </h2>
      </div>

      <div class="col-xs-6 text-right">

        <fieldset ng-hide="viewOnly">

        <!-- TODO: EXPORT BUTTONS ONLY AVAILABLE ON VIEW/EDIT NOT CREATE -->
<!--             <button type="button" class="btn btn-info"> -->
<!--               <span class="glyphicon glyphicon-export" aria-hidden="true"></span> -->
<!--               <span>Export (Excel)</span> -->
<!--             </button> -->
<!--             <button type="button" class="btn btn-info"> -->
<!--               <span class="glyphicon glyphicon-export" aria-hidden="true"></span> -->
<!--               <span>Export (PDF)</span> -->
<!--             </button> -->

            <button class="btn btn-primary" ng-show="canReview" ng-click="toggleReview()">
              <span>Review</span>
            </button>

            <button class="btn btn-primary" ng-click="save(false)" ng-show="state == 'review'">
              <span>Save</span>
            </button>

            <button class="btn btn-default" ng-click="cancel()" ng-hide="readOnly && state !='review'">Cancel</button>

            <button class="btn btn-primary" ng-click="save(true)" ng-show="state == 'review'">
              <span class="fa fa-check-square-o" aria-hidden="true"></span>
              <span>Submit</span>
            </button>

        </fieldset>

      </div>

    </div>
  </div>

  <form class="form edit-form delivery-note-form">

    <form-error-dialog></form-error-dialog>
    <!--/TopHeader -->

    <div class="panel panel-default">
      <div class="panel-heading">
        <!-- form header-->
        <div class="row">
          <div class="col-xs-12 col-sm-4">
            <div class="form-group">
              <label>LMP Station*</label>
              <select class="form-control" ng-model="deliveryNote.catererStationId" ng-change="updateDeliveryInfo()"
                      ng-disabled="readOnly || catererStationList.length == 1" ng-show="catererStationList.length">
                <option ng-repeat="station in catererStationList track by $index" ng-value="station.id"
                        ng-selected="catererStationList.length == 1 || station.id == deliveryNote.catererStationId">
                  {{ station.code }} ({{ station.name}})</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="panel-body">

        <div class="row" ng-hide="state == 'review'">

          <div class="col-xs-12 col-sm-3">
            <div class="form-group">
              <label for="delivery-note-number">Delivery Note Number*</label>
              <input ng-model="deliveryNote.deliveryNoteNumber" name="deliveryNoteNumber" type="text" class="form-control" id="delivery-note-number"
                     required custom-validity custom-pattern="time" ng-readonly="readOnly">
            </div>
          </div>

          <div class="col-xs-12 col-sm-3">
            <div class="form-group">
              <label for="purchase-order-number">Purchase Order Number*</label>
              <input ng-model="deliveryNote.purchaseOrderNumber" name="purchaseOrderNumber" type="text" class="form-control" id="purchase-order-number"
                     required custom-validity custom-pattern="time" ng-readonly="readOnly">
            </div>
          </div>

          <date-picker
            class="col-xs-12 col-sm-2"
            element-class="form-group"
            disable-date-range="true"
            start-date-model="deliveryNote.deliveryDate"
            is-search-field="true"
            disable-start-date="readOnly"
            label-from="Delivery Date *">
          </date-picker>

          <!-- TODO: STATUS ONLY AVAILABLE ON VIEW/EDIT NOT CREATE -->
          <div class="col-xs-12 col-sm-2" ng-show="{{ state == 'view' || state == 'edit' }}">
            <div class="form-group">
              <label>Status</label>
              <input ng-model="deliveryStatus" type="text" class="form-control" id="delivery-status"
                     placeholder="Saved" ng-readonly="readOnly" ng-disabled="true">
            </div>
          </div>

        </div>

        <div class="row" ng-show="state == 'view' || state == 'edit'" ng-hide="state == 'review'">
        <!-- TODO: THIS ROW ONLY AVAILABLE ON VIEW/EDIT NOT CREATE -->

          <div class="col-xs-12 col-sm-2">
            <div class="form-group">
              <label>Created By</label>
              <input ng-model="deliveryNote.createdBy" type="text" class="form-control" readonly="readonly">
            </div>
          </div>

          <div class="col-xs-12 col-sm-2">
            <div class="form-group">
              <label>Created Date/Time</label>
              <input ng-model="deliveryNote.createdOn" type="text" class="form-control" readonly="readonly">
            </div>
          </div>

          <div class="col-xs-12 col-sm-2">
            <div class="form-group">
              <label>Updated By</label>
              <input ng-model="deliveryNote.updatedBy" type="text" class="form-control" readonly="readonly">
            </div>
          </div>

          <div class="col-xs-12 col-sm-2">
            <div class="form-group">
              <label>Updated Date/Time</label>
              <input ng-model="deliveryNote.updatedOn" type="text" class="form-control" readonly="readonly">
            </div>
          </div>

        </div>

<!-- TODO: FILTER ADJUSTS TABLE DATA BELOW -->
        <div class="row" ng-show="deliveryNote.items.length && state != 'review'">
          <div class="col-xs-12 col-sm-1">
            <div class="form-group">
              <label>Filter by:</label>
            </div>
          </div>
          <div class="col-xs-12 col-sm-2">
            <div class="form-group">
              <label for="filter-item-code">Item Code</label>
              <input ng-model="filterInput.itemCode" type="text" class="form-control" id="filter-item-code">
            </div>
          </div>
          <div class="col-xs-12 col-sm-2">
            <div class="form-group">
              <label for="filter-item-name">Item Name</label>
              <input ng-model="filterInput.itemName" type="text" class="form-control" id="filter-item-name">
            </div>
          </div>
        </div>

<!-- TODO: THIS WELL/ROW WILL BE ADDED WITH "+ADD ITEMS" BUTTON (BELOW) -->
        <div class="well" ng-repeat="item in deliveryNote.items | filter:filterInput track by item.masterItemId">
          <div class="row">

            <div class="col-xs-10 col-sm-11">

              <div class="col-xs-12 col-sm-2">
                <div class="form-group">
                  <label>Item Code</label>
                  <input ng-model="item.itemCode" type="text" class="form-control" readonly="readonly">
                </div>
              </div>

  <!-- TODO: ITEM CODE (ABOVE) WILL BE AFFECTED BY ITEM NAME (BELOW) AND PULL CORRECT DATA -->
              <div class="col-xs-12 col-sm-4">
                <div class="form-group">
                  <label>Item Name*</label>
                   <input ng-model="item.itemName" type="text" class="form-control" readonly="readonly">
                </div>
              </div>

              <div class="col-xs-12 col-sm-1">
                <div class="form-group">
                  <label for="expected-qty-{{ item.masterItemId }}">Expected</label>
                  <input ng-model="item.expectedQuantity" type="text" class="form-control"
                         id="expected-qty-{{ item.masterItemId }}"
                         custom-validity custom-pattern="number"
                         ng-readonly="readOnly">
                </div>
              </div>

              <div class="col-xs-12 col-sm-1">
                <div class="form-group">
                  <label for="delivered-qty-{{ item.masterItemId }}">Delivered*</label>
                  <input ng-model="item.deliveredQuantity" type="text" class="form-control"
                         id="delivered-qty-{{ item.masterItemId }}"
                         custom-validity custom-pattern="number"
                         ng-readonly="readOnly" ng-required="true">
                </div>
              </div>

              <div class="col-xs-12 col-sm-1">
                <div class="form-group" ng-hide="readOnly && !item.ullageQuantity">
                  <label for="ullage-qty-{{ item.masterItemId }}">Ullage</label>
                  <input ng-model="item.ullageQuantity" type="text" class="form-control"
                         id="ullage-qty-{{ item.masterItemId }}"
                         custom-validity custom-pattern="number"
                         ng-readonly="readOnly">
                </div>
              </div>

  <!-- TODO: ULLAGE REASON (BELOW) WILL BE DISABLED UNLESS ULLAGE (ABOVE) IS SET TO AN AMOUNT -->
              <div class="col-xs-12 col-sm-2">
                <div class="form-group" ng-show="item.ullageQuantity">
                  <label>Ullage Reason*</label>
                  <ui-select ng-model="selectedUllageReason[item.masterItemId].selected" theme="bootstrap"
                             ng-disabled="readOnly || !item.ullageQuantity"
                             tagging tagging-label="false"
                             on-select="ullageReasonOnSelect($select,$item,item.masterItemId)">
                    <ui-select-match>{{ $select.selected.companyReasonCodeName }}</ui-select-match>
                    <ui-select-choices repeat="ullageReason in ullageReasons">
                      <div ng-bind-html="ullageReason.companyReasonCodeName"></div>
                    </ui-select-choices>
                  </ui-select>

                </div>
              </div>

              <div class="col-xs-12 col-sm-1">
                <div class="form-group">
                  <label for="booked-qty-{{ item.masterItemId }}">Booked</label>
                  <input ng-model="item.bookedQuantity" type="text" class="form-control"
                         id="booked-qty-{{ item.masterItemId }}"
                         custom-validity custom-pattern="number"
                         ng-readonly="readOnly" ng-disabled="true">
                </div>
              </div>

            </div>

            <div class="col-xs-2 col-sm-1 text-right" ng-hide="readOnly">
              <button type="button" class="btn btn-sm btn-danger" ng-click="removeItemByIndex($index)">
                <i class="fa fa-close"></i>
              </button>
            </div>

          </div>
        </div>

        <div class="row" ng-hide="readOnly">
          <div class="col-xs-12 col-sm-9"></div>
          <div class="col-xs-12 col-sm-3 text-right">
            <div class="input-group">
              <input type="text" class="form-control">
              <span class="input-group-btn">
                <button class="btn btn-primary" type="button"><i class="fa fa-plus"></i> Add Items</button>
              </span>
            </div>
          </div>
        </div>

      </div>

    </div>

  </form>

</div>
<!-- /Container -->

<form-success-modal></form-success-modal>

<form-update-modal></form-update-modal>

<leave-view-modal></leave-view-modal>

<dynamic-left-nav></dynamic-left-nav>
